<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="edxtras">
<title>edxtras • edxtras</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="edxtras">
<meta property="og:description" content="edxtras">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">edxtras</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/edxtras.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>edxtras</h1>
            
      
      
      <div class="d-none name"><code>edxtras.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="get-started">Get Started<a class="anchor" aria-label="anchor" href="#get-started"></a>
</h2>
<p><a href="https://github.com/peernisse/edxtras" class="external-link">Browse
<code>edxtras</code> source code</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://peernisse.github.io/edxtras/">edxtras</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-use-case">Example use case<a class="anchor" aria-label="anchor" href="#example-use-case"></a>
</h2>
<p>Data are provided to you regularly from multiple sources in tabular
format. The data are required to contain certain columns and those
columns should be complete and comply with certain rules for quality
control. You need to track and report the quality of the data delivered
from each source.</p>
<div class="section level3">
<h3 id="create-demonstration-data">Create demonstration data<a class="anchor" aria-label="anchor" href="#create-demonstration-data"></a>
</h3>
<p>Let’s create two datasets to demonstrate using <code>edxtras</code>
to accomplish this.</p>
<div class="section level4">
<h4 id="dataset-1">Dataset 1<a class="anchor" aria-label="anchor" href="#dataset-1"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu">edxtras</span><span class="fu">::</span><span class="va"><a href="../reference/zipcodeDB.html">zipcodeDB</a></span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'zipcode'</span>, <span class="st">'lat'</span>, <span class="st">'lng'</span>, <span class="st">'post_office_city'</span>, <span class="st">'state'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    41877 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ zipcode         : chr  "35004" "35005" "35006" "35007" ...</span></span>
<span><span class="co">#&gt;  $ lat             : num  33.6 33.6 33.4 33.2 32.9 ...</span></span>
<span><span class="co">#&gt;  $ lng             : num  -86.5 -87 -87.2 -86.8 -85.9 ...</span></span>
<span><span class="co">#&gt;  $ post_office_city: chr  "Moody, AL" "Adamsville, AL" "Adger, AL" "Alabaster, AL" ...</span></span>
<span><span class="co">#&gt;  $ state           : chr  "AL" "AL" "AL" "AL" ...</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="dataset-2">Dataset 2<a class="anchor" aria-label="anchor" href="#dataset-2"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sampleDates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2020-01-01'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span><span class="op">)</span>, <span class="st">'day'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="st">'reporter'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Rep A'</span>, <span class="st">'Rep B'</span>, <span class="st">'Rep C'</span><span class="op">)</span>, <span class="fl">3000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">'description'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'short description'</span>, <span class="st">'a slightly longer description'</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">3000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="st">'date'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sampleDates</span><span class="op">)</span>, <span class="fl">3000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">'values'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span><span class="op">:</span><span class="fl">1000</span>, <span class="fl">3000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    3000 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;  $ reporter   : chr  "Rep A" "Rep A" "Rep A" "Rep A" ...</span></span>
<span><span class="co">#&gt;  $ description: chr  NA "a slightly longer description" "a slightly longer description" "short description" ...</span></span>
<span><span class="co">#&gt;  $ date       : chr  "2020-01-18" "2022-11-19" "2020-06-15" "2021-12-21" ...</span></span>
<span><span class="co">#&gt;  $ values     : int  970 647 933 151 916 638 835 172 274 975 ...</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="hypothetical-validation-requirements">Hypothetical validation requirements<a class="anchor" aria-label="anchor" href="#hypothetical-validation-requirements"></a>
</h3>
<p><strong>Dataset 1</strong></p>
<ul>
<li>zipcodes not empty and exactly 5 characters</li>
<li>lattitudes not empty and are positive</li>
<li>longitudes not empty and are negative</li>
<li>post office city not empty and of the form “City, ST”</li>
<li>State abbreviation not empty and exactly 2 characters</li>
</ul>
<p><strong>Dataset 2</strong></p>
<ul>
<li>Description is not empty and is alpha-numeric</li>
<li>Date is not in the future</li>
<li>Values are positive</li>
</ul>
</div>
<div class="section level3">
<h3 id="create-list-of-validation-functions-for-each-dataset">Create list of validation functions for each dataset<a class="anchor" aria-label="anchor" href="#create-list-of-validation-functions-for-each-dataset"></a>
</h3>
<p>The key element for using the <code>edxtras</code> package is the
<code>validRules</code> S3 class. It creates a named list of class
<code>validRules</code> where you will create custom validation
functions for your data and use case. Validation rules should:</p>
<ul>
<li>Return TRUE/FALSE</li>
<li>Be named in the list as to correspond to vector or column names the
rule is designed to validate</li>
</ul>
</div>
<div class="section level3">
<h3 id="create-rules-for-validation-requirements">Create rules for validation requirements<a class="anchor" aria-label="anchor" href="#create-rules-for-validation-requirements"></a>
</h3>
<p>Let’s use <code><a href="../reference/validRules.html">validRules()</a></code> to create the validation
functions for the datasets We want to define the logic that will be
applied to each element in a dataframe column and return TRUE or FALSE
whether the value passes the rule.</p>
<p><strong>Dataset 1</strong> We construct a named list of validation
functions. The names of the functions correspond to column names in
<code>df1</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create named list of functions that check the requirements </span></span>
<span></span>
<span><span class="va">df1Rules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">'zipcode'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span>,</span>
<span>    <span class="st">'lat'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>    <span class="st">'lng'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0</span>,</span>
<span>    <span class="st">'post_office_city'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^[A-Za-z]+,[ ]?[A-Za-z]+{2,}$'</span>, <span class="va">x</span><span class="op">)</span>,</span>
<span>    <span class="st">'state'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add the `df1Rules` list as a ruleset named "df1Rules" to a new validRules() object</span></span>
<span></span>
<span><span class="va">projectValidationRules</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validRules.html">validRules</a></span><span class="op">(</span><span class="va">df1Rules</span>, ruleset <span class="op">=</span> <span class="st">'df1Rules'</span><span class="op">)</span></span>
<span><span class="va">projectValidationRules</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   Ruleset  Name             Rule                                                </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> df1Rules zipcode          function(x) !is.na(x) &amp; nchar(x) == 5               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> df1Rules lat              function(x) !is.na(x) &amp; x &gt; 0                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> df1Rules lng              function(x) !is.na(x) &amp; x &lt; 0                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> df1Rules post_office_city function(x) !is.na(x) &amp; grepl('^[A-Za-z]+,[ ]?[A-Za…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> df1Rules state            function(x) !is.na(x) &amp; nchar(x) == 2</span></span></code></pre></div>
<p><strong>Dataset 2</strong> We construct a named list of validation
functions. The names of the functions correspond to column names in
<code>df2</code>. We use <code><a href="../reference/addRules.html">addRules()</a></code> to add another group of
rules (ruleset) in the <code>projectValidationRules</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create named list of functions that check the requirements </span></span>
<span></span>
<span><span class="va">df2Rules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">'description'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">!=</span> <span class="st">""</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^[A-Za-z]'</span>, <span class="va">x</span><span class="op">)</span>,</span>
<span>    <span class="st">'date'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="st">'values'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add the `df2Rules` list as a ruleset named "df2Rules" to `projectValidationRules`</span></span>
<span></span>
<span><span class="va">projectValidationRules</span> <span class="op">&lt;-</span> <span class="va">projectValidationRules</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/addRules.html">addRules</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">df2Rules</span>, <span class="st">'df2Rules'</span><span class="op">)</span></span>
<span><span class="va">projectValidationRules</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">#&gt;   Ruleset  Name             Rule                                                </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> df1Rules zipcode          <span style="color: #949494;">"</span>function(x) !is.na(x) &amp; nchar(x) == 5<span style="color: #949494;">"</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> df1Rules lat              <span style="color: #949494;">"</span>function(x) !is.na(x) &amp; x &gt; 0<span style="color: #949494;">"</span>                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> df1Rules lng              <span style="color: #949494;">"</span>function(x) !is.na(x) &amp; x &lt; 0<span style="color: #949494;">"</span>                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> df1Rules post_office_city <span style="color: #949494;">"</span>function(x) !is.na(x) &amp; grepl('^[A-Za-z]+,[ ]?[A-Z…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> df1Rules state            <span style="color: #949494;">"</span>function(x) !is.na(x) &amp; nchar(x) == 2<span style="color: #949494;">"</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> df2Rules description      <span style="color: #949494;">"</span>function(x) !is.na(x) &amp; x != \"\" &amp; grepl('^[A-Za-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> df2Rules date             <span style="color: #949494;">"</span>function(x) as.Date(x) &lt;= Sys.Date()<span style="color: #949494;">"</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> df2Rules values           <span style="color: #949494;">"</span>function(x) x &gt;= 0<span style="color: #949494;">"</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="apply-validation-rules-to-the-data">Apply validation rules to the data<a class="anchor" aria-label="anchor" href="#apply-validation-rules-to-the-data"></a>
</h3>
<p>Let’s use <code><a href="../reference/validateDF.html">validateDF()</a></code> to summarize percent of values in
each column passing validation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Validate df1 - returns percent valid</span></span>
<span></span>
<span><span class="va">scoreDF1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validateDF.html">validateDF</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">projectValidationRules</span>, <span class="st">'df1Rules'</span><span class="op">)</span></span>
<span><span class="va">scoreDF1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   zipcode   lat   lng post_office_city state</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     100  79.1    79             60.4   100</span></span>
<span></span>
<span><span class="co"># Validate df2 - returns percent valid</span></span>
<span></span>
<span><span class="va">scoreDF2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validateDF.html">validateDF</a></span><span class="op">(</span><span class="va">df2</span>, <span class="va">projectValidationRules</span>, <span class="st">'df2Rules'</span><span class="op">)</span></span>
<span><span class="va">scoreDF2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   reporter description  date values</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       <span style="color: #BB0000;">NA</span>        67.7  93.6   90.3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarize-validity-and-completeness">Summarize validity and completeness<a class="anchor" aria-label="anchor" href="#summarize-validity-and-completeness"></a>
</h3>
<p>Let’s use <code><a href="../reference/makeValidData.html">makeValidData()</a></code> to evaluate percent
completeness and validity for a specific group.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Evaluate percent completeness (not empty) and validity (passes column rule) </span></span>
<span><span class="co"># by a grouping column (e.g., state) and filter value (e.g., TX)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/makeValidData.html">makeValidData</a></span><span class="op">(</span><span class="va">df1</span>, </span>
<span>    indexCol <span class="op">=</span> <span class="st">'state'</span>, </span>
<span>    filtRep <span class="op">=</span> <span class="st">'TX'</span>, </span>
<span>    rulesObj <span class="op">=</span> <span class="va">projectValidationRules</span>, </span>
<span>    ruleset <span class="op">=</span> <span class="st">'df1Rules'</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   state metric       zipcode   lat   lng post_office_city</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TX    Completeness     100  72.8  72.8             72.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TX    Validity         100  72.8  72.8             57.5</span></span>
<span></span>
<span><span class="fu"><a href="../reference/makeValidData.html">makeValidData</a></span><span class="op">(</span><span class="va">df2</span>, </span>
<span>    indexCol <span class="op">=</span> <span class="st">'reporter'</span>, </span>
<span>    filtRep <span class="op">=</span> <span class="st">'Rep A'</span>, </span>
<span>    rulesObj <span class="op">=</span> <span class="va">projectValidationRules</span>, </span>
<span>    ruleset <span class="op">=</span> <span class="st">'df2Rules'</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   reporter metric       description  date values</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Rep A    Completeness        67.2 100    100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Rep A    Validity            67.2  94.2   90.6</span></span></code></pre></div>
<p>Let’s use <code><a href="../reference/makeValidData.html">makeValidData()</a></code> and
<code><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">purrr::map_df()</a></code> to summarize percent completeness and
validity for all groups.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use `purrr::map_df()` to summarize by the groups</span></span>
<span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">state</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">states</span>, <span class="op">~</span> </span>
<span>    <span class="fu"><a href="../reference/makeValidData.html">makeValidData</a></span><span class="op">(</span><span class="va">df1</span>, </span>
<span>        indexCol <span class="op">=</span> <span class="st">'state'</span>, </span>
<span>        filtRep <span class="op">=</span> <span class="va">.x</span>, </span>
<span>        rulesObj <span class="op">=</span> <span class="va">projectValidationRules</span>, </span>
<span>        ruleset <span class="op">=</span> <span class="st">'df1Rules'</span></span>
<span>    <span class="op">)</span>           </span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 104 × 6</span></span></span>
<span><span class="co">#&gt;    state metric       zipcode   lat   lng post_office_city</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AK    Completeness     100  86.9  86.9             86.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AK    Validity         100  86.9  86.5             62.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> AL    Completeness     100  76.5  76.5             76.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> AL    Validity         100  76.5  76.5             65.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> AR    Completeness     100  83.2  83.2             83.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AR    Validity         100  83.2  83.2             64.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AZ    Completeness     100  71.3  71.3             71.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AZ    Validity         100  71.3  71.3             55.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> CA    Completeness     100  66.4  66.4             66.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> CA    Validity         100  66.4  66.4             38.2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 94 more rows</span></span></span>
<span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">reporter</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">reps</span>, <span class="op">~</span> </span>
<span>    <span class="fu"><a href="../reference/makeValidData.html">makeValidData</a></span><span class="op">(</span><span class="va">df2</span>, </span>
<span>        indexCol <span class="op">=</span> <span class="st">'reporter'</span>, </span>
<span>        filtRep <span class="op">=</span> <span class="va">.x</span>, </span>
<span>        rulesObj <span class="op">=</span> <span class="va">projectValidationRules</span>, </span>
<span>        ruleset <span class="op">=</span> <span class="st">'df2Rules'</span></span>
<span>    <span class="op">)</span>           </span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   reporter metric       description  date values</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Rep A    Completeness        67.2 100    100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Rep A    Validity            67.2  94.2   90.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Rep B    Completeness        69.7 100    100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Rep B    Validity            69.7  94.2   89.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Rep C    Completeness        66.3 100    100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Rep C    Validity            66.3  92.3   90.4</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peter EerNisse.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
